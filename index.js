import{n as u,e as ie,a as q,A as oe,q as $,y as C,b as t,u as De,k as G,d as g,c as de,E as Ce,R as Ne,f as K,L as Ie}from"./vendor.js";import{D as xe}from"./device-card.js";import"./index.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const d of i)if(d.type==="childList")for(const a of d.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const d={};return i.integrity&&(d.integrity=i.integrity),i.referrerPolicy&&(d.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?d.credentials="include":i.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function r(i){if(i.ep)return;i.ep=!0;const d=n(i);fetch(i.href,d)}})();const P="192.168.4.1";class Me{constructor(e={}){this.messageSubscribers=[],this.statusSubscribers=[],this.testing=void 0,this.isConnected=!1,this.onLoadingEnd=e.onLoadingEnd}connect(e){setTimeout(()=>{this.isConnected=!0,this.notifyStatus("connected")},500)}disconnect(){this.isConnected=!1,this.notifyStatus("disconnected")}reconnect(){this.disconnect(),this.connect("")}send(e){console.log("[MockSocket] Sending:",e),setTimeout(()=>{if((e==null?void 0:e.driver)==="find"&&(e==null?void 0:e.cmd)==="start"&&this.emitMessage({driver:"find",cmd:"stop",count:64}),(e==null?void 0:e.driver)==="update"){const n=[2,4,6,7,96,98,128],r=Object.fromEntries(Array.from({length:13},(i,d)=>[`d${d}`,[d,n[Math.floor(Math.random()*n.length)]]]));this.emitMessage({driver:"update",count:64,drivers:r})}if((e==null?void 0:e.driver)==="test"&&(e==null?void 0:e.cmd)==="start"&&(e==null?void 0:e.addres)!==void 0&&(this.testing=e==null?void 0:e.addres,this.emitMessage({driver:"test",cmd:"on",addres:e==null?void 0:e.addres})),e==="status"&&this.emitMessage("free"),(e==null?void 0:e.driver)==="test"&&(e==null?void 0:e.cmd)==="stop"&&(e==null?void 0:e.addres)!==void 0&&this.emitMessage({driver:"test",cmd:"stop",status:"ok"}),(e==null?void 0:e.master)==="scan"){const n=["MyWiFi","OfficeNet","Guest123","RedmiOasdasdasdasdasdne","Sosedi","Mazda","XBOXasdasdasdasd","TANK","RedmiOne","Sosedi","Mazda","XBOX","TANK"];this.emitMessage({master:"scan",cmd:"stop",ssid:n})}(e==null?void 0:e.master)==="net"&&this.emitMessage({master:"net",cmd:"ok"}),e==="Connected"&&this.emitMessage("Connected"),(e==null?void 0:e.master)==="bus"&&(e==null?void 0:e.cmd)==="state"&&this.emitMessage({master:"bus",cmd:"state",state:1}),(e==null?void 0:e.driver)==="settyngs"&&(e==null?void 0:e.cmd)==="download"&&typeof(e==null?void 0:e.addres)=="number"&&this.emitMessage({driver:"settyngs",cmd:"download",dr_settyngs:[e==null?void 0:e.addres,98,156,156,30,50,30,50,0,5,55]}),(e==null?void 0:e.driver)==="settyngs"&&(e==null?void 0:e.cmd)==="save"&&this.emitMessage({driver:"settyngs",cmd:"save",state:"ok"}),(e==null?void 0:e.rooms)==="search"&&(e==null?void 0:e.cmd)==="start"&&this.emitMessage({rooms:"search",cmd:"download",roomsArr:[{idRoom:u(),roomName:"Коридор",drivers:{d0:[0,1],d1:[1,4]},groups:[{idGroup:u(),groupName:"Центральный свет",driverAddresses:{d0:[18,7],d1:[19,4],d2:[20,4]}},{idGroup:u(),groupName:"Гараж",driverAddresses:{d3:[21,6],d4:[22,4],d5:[23,8]}},{idGroup:u(),groupName:"Подсветка по периметру",driverAddresses:{d3:[21,6],d4:[22,4],d5:[23,8]}},{idGroup:u(),groupName:"Подсобное помещение",driverAddresses:{d3:[31,6],d4:[42,4],d5:[53,8]}}]},{idRoom:u(),roomName:"Спальня",drivers:{d0:[4,7],d1:[5,4]},groups:[{idGroup:u(),groupName:"Все включено",driverAddresses:{d0:[18,7],d1:[19,4],d2:[20,4]}},{idGroup:u(),groupName:"Ночной режим",driverAddresses:{d3:[31,6],d4:[42,4],d5:[53,8]}}]},{idRoom:u(),roomName:"Гостинная",drivers:{d6:[24,4],d7:[25,4],d8:[26,6]},groups:[{idGroup:u(),groupName:"Центральный свет",driverAddresses:{d0:[18,7],d1:[19,4],d2:[20,4]}},{idGroup:u(),groupName:"Уход",driverAddresses:{d3:[21,6],d4:[22,4],d5:[23,8]}},{idGroup:u(),groupName:"Встреча гостей",driverAddresses:{d3:[21,6],d4:[22,4],d5:[23,8]}},{idGroup:u(),groupName:"Романтика",driverAddresses:{d3:[21,6],d4:[22,4],d5:[23,8]}},{idGroup:u(),groupName:"Свет везде",driverAddresses:{d3:[21,6],d4:[22,4],d5:[23,8]}},{idGroup:u(),groupName:"Подсветка по периметру",driverAddresses:{d3:[21,6],d4:[22,4],d5:[23,8]}},{idGroup:u(),groupName:"Обеденный свет",driverAddresses:{d3:[31,6],d4:[42,4],d5:[53,8]}}]}]}),(e==null?void 0:e.rooms)==="search"&&(e==null?void 0:e.cmd)==="start"&&this.emitMessage({rooms:"search",cmd:"download",roomsArr:[{idRoom:u(),roomName:"Коридор",drivers:{d0:[0,1],d1:[1,4]},groups:[{idGroup:u(),groupName:"Центральный свет",driverAddresses:{d0:[18,7],d1:[19,4],d2:[20,4]}},{idGroup:u(),groupName:"Гараж",driverAddresses:{d3:[21,6],d4:[22,4],d5:[23,8]}},{idGroup:u(),groupName:"Подсветка по периметру",driverAddresses:{d3:[21,6],d4:[22,4],d5:[23,8]}},{idGroup:u(),groupName:"Подсобное помещение",driverAddresses:{d3:[31,6],d4:[42,4],d5:[53,8]}}]},{idRoom:u(),roomName:"Спальня",drivers:{d0:[4,7],d1:[5,4]},groups:[{idGroup:u(),groupName:"Все включено",driverAddresses:{d0:[18,7],d1:[19,4],d2:[20,4]}},{idGroup:u(),groupName:"Ночной режим",driverAddresses:{d3:[31,6],d4:[42,4],d5:[53,8]}}]},{idRoom:u(),roomName:"Гостинная",drivers:{d6:[24,4],d7:[25,4],d8:[26,6]},groups:[{idGroup:u(),groupName:"Центральный свет",driverAddresses:{d0:[18,7],d1:[19,4],d2:[20,4]}},{idGroup:u(),groupName:"Уход",driverAddresses:{d3:[21,6],d4:[22,4],d5:[23,8]}},{idGroup:u(),groupName:"Встреча гостей",driverAddresses:{d3:[21,6],d4:[22,4],d5:[23,8]}},{idGroup:u(),groupName:"Романтика",driverAddresses:{d3:[21,6],d4:[22,4],d5:[23,8]}},{idGroup:u(),groupName:"Свет везде",driverAddresses:{d3:[21,6],d4:[22,4],d5:[23,8]}},{idGroup:u(),groupName:"Подсветка по периметру",driverAddresses:{d3:[21,6],d4:[22,4],d5:[23,8]}},{idGroup:u(),groupName:"Обеденный свет",driverAddresses:{d3:[31,6],d4:[42,4],d5:[53,8]}}]}]})},2e3)}onMessage(e){return this.messageSubscribers.push(e),()=>{this.messageSubscribers=this.messageSubscribers.filter(n=>n!==e)}}onStatus(e){return this.statusSubscribers.push(e),()=>{this.statusSubscribers=this.statusSubscribers.filter(n=>n!==e)}}delay(e){return new Promise(n=>setTimeout(n,e))}notifyStatus(e){this.statusSubscribers.forEach(n=>n(e))}emitMessage(e){this.messageSubscribers.forEach(n=>n(e))}}const b=new Me,We="_drawer_1sl5f_1",ke="_active_1sl5f_16",Te="_menu_1sl5f_22",Se="_activeLink_1sl5f_43",H={drawer:We,active:ke,menu:Te,activeLink:Se};var Y=(s=>(s.PENDING="pending",s.CONNECTED="connected",s.DISCONNECTED="disconnected",s.ERROR="error",s))(Y||{});const l=ie({socketURL:window.location.hostname,socketStatus:Y.DISCONNECTED,wifiNetworks:[],settingsDriver:[],updatedDevices:{},rooms:[],groups:Array(16).fill(!1),countDrivers:void 0,onlineCountDrivers:void 0,testingDriverAddress:void 0,stateBus:void 0}),_=ie({isActiveMenu:!1,isLoadingUI:!1,isLoadingIntervalStatus:!1}),Le=()=>{const{url:s,route:e}=q(),n=oe(null),r=$(i=>{_.value={..._.value,isActiveMenu:!1},e(i)},[]);return C(()=>{const i=d=>{n.current&&!n.current.contains(d.target)&&(_.value={..._.value,isActiveMenu:!1})};return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[]),t("div",{ref:n,className:`${H.drawer} ${_.value.isActiveMenu?H.active:""}`,children:t("div",{className:H.menu,children:[t("div",{className:s==="/service/devices"?H.activeLink:"",onClick:()=>r("/service/devices"),children:"Драйверы"}),t("div",{className:s==="/settings"?H.activeLink:"",onClick:()=>r("/settings"),children:"Wi-Fi"})]})})},Ae="_header_1898u_1",Be="_burgerBtn_1898u_18",ze="_burgerBtnItem_1898u_27",$e="_stateBusIndicatorActive_1898u_80",Ge="_stateBusIndicatorDisabled_1898u_89",Pe="_title_1898u_98",B={header:Ae,burgerBtn:Be,burgerBtnItem:ze,stateBusIndicatorActive:$e,stateBusIndicatorDisabled:Ge,title:Pe},Ee=s=>{if(s==="/")return"Главная";if(s==="/service/devices")return"Поиск драйверов";if(s==="/service/sensors")return"Сенсоры";if(s.startsWith("/service/devices/")){const r=q().path.split("/");return`Драйвер №${r[r.length-1]}`}return s.startsWith("/service/sensors/")?"Сенсор":s==="/service/rooms"?"Помещения и группы":s==="/settings"?"Настройки Wi-Fi":"Страница"},Fe=({width:s=24,height:e=24,scale:n=1,color:r="#ffffff",backgroundColor:i="#141414",className:d=""})=>{const a=typeof s=="number"?s*n:s,v=typeof e=="number"?e*n:e;return t("svg",{width:a,height:v,viewBox:"0 0 439.488 443.88",class:`info-icon ${d}`,xmlns:"http://www.w3.org/2000/svg",children:[t("path",{d:"M219.744 443.88C341.103 443.88 439.488 344.51 439.488 221.94C439.488 99.368 341.103 0 219.744 0C98.387 0 0 99.368 0 221.94C0 344.51 98.387 443.88 219.744 443.88z",fill:r}),t("path",{d:"M219.744 392.714C313.128 392.714 388.83 316.255 388.83 221.94C388.83 127.623 313.128 51.166 219.744 51.166C126.362 51.166 50.659 127.623 50.659 221.94C50.659 316.255 126.362 392.714 219.744 392.714z",fill:i}),t("path",{d:"M196.963 300.274L246.494 300.172L246.494 261.69C246.494 251.252 251.36 241.39 264.38 232.849C277.399 224.312 313.744 206.988 313.744 161.44C313.744 115.89 275.577 84.582 243.494 77.94C211.416 71.298 176.659 75.668 151.994 102.69C129.907 126.887 125.253 146.027 125.253 188.255L174.744 188.255L174.744 178.44C174.744 155.939 177.347 132.186 209.494 125.69C227.04 122.144 243.488 127.648 253.244 137.19C264.404 148.102 264.494 172.69 246.711 184.933L218.815 203.912C202.543 214.35 196.963 225.971 196.963 243.051L196.963 300.274z",fill:r}),t("path",{d:"M196.638 370.692L196.638 319.687L246.85 319.687L246.85 370.692L196.638 370.692z",fill:r})]})};function Re(){l.value.socketStatus;const s=q(),{params:e}=De(),n=Ee(s.path);return t(G,{children:[t("div",{className:B.header,children:t("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",maxWidth:"500px",margin:"0 auto"},children:[t("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start",gap:"14px",flex:"0 0 auto"},children:t("div",{className:B.burgerBtn,onClick:()=>{_.value={..._.value,isActiveMenu:!_.value.isActiveMenu}},children:[t("div",{className:B.burgerBtnItem}),t("div",{className:B.burgerBtnItem}),t("div",{className:B.burgerBtnItem})]})}),t("div",{className:B.title,children:n}),t("div",{style:{display:"flex",gap:"8px"},children:[t("div",{className:l.value.socketStatus===Y.CONNECTED?B.stateBusIndicatorActive:B.stateBusIndicatorDisabled}),t(Fe,{})]})]})}),t(Le,{})]})}const Oe="_wrapper_h7i63_1",He={wrapper:Oe},je=({children:s})=>t("div",{className:He.wrapper,children:s});function F(){const[s,e]=g(!1),[n,r]=g(!1),[i,d]=g(!1),[a,v]=g(!1),[p,m]=g(!1),[f,w]=g(!1),[T,N]=g(!1);return C(()=>{const x=()=>{e(window.innerWidth<=599),r(window.innerWidth<=1100),d(window.innerWidth<=380),v(window.innerWidth<=360),m(window.innerWidth<=340),w(window.innerWidth<=400),N(window.innerWidth<=440)};return x(),window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[]),{isMobile:s,isMobile1100:n,isMobile380:i,isMobile360:a,isMobile340:p,isMobile400:f,isMobile440:T}}const Ue="_toastContainer_c3ggs_3",Ve="_toast_c3ggs_3",qe="_fadeIn_c3ggs_1",Ke="_fadeOut_c3ggs_1",Xe="_success_c3ggs_28",Qe="_warning_c3ggs_33",Je="_error_c3ggs_38",te={toastContainer:Ue,toast:Ve,fadeIn:qe,fadeOut:Ke,success:Xe,warning:Qe,error:Je},E=ie([]);let Ye=0;class Ze{create(e,n,r=3e3){const i=++Ye;E.value=[...E.value,{id:i,message:e,type:n}],setTimeout(()=>this.hide(i),r)}showSuccess(e,n){this.create(e,"success",n)}showWarning(e,n){this.create(e,"warning",n)}showError(e,n){l.value.socketStatus===Y.CONNECTED?this.create(e,"error",n):this.create("Нет связи с мастером","error",n)}hide(e){E.value=E.value.filter(n=>n.id!==e)}}const D=new Ze,es=()=>{const[s,e]=g(E.value);return C(()=>E.subscribe(r=>e(r)),[]),t("div",{className:te.toastContainer,children:s.map(n=>t("div",{className:`${te.toast} ${te[n.type]}`,onClick:()=>D.hide(n.id),children:n.message},n.id))})},ss="_layoutContainer_6dz2s_1",ts={layoutContainer:ss},o={findDriver:null,updateDrivers:null,saveDrivers:null,saveSettingsDriver:null,startTestDriver:null,saveWIFI:null,scanWIFI:null,stateBus:null,saveAP:null},c={updateDrivers:0,saveDrivers:0,saveSettingsDriver:0,startTestDriver:0,saveWIFI:0,scanWIFI:0,saveAP:0},rs=s=>{b.reconnect(s)},z=()=>{_.value={..._.value,isLoadingUI:!0}},ae=s=>{l.value={...l.value,onlineCountDrivers:s}},ns=()=>{_.value={..._.value,isLoadingIntervalStatus:!1}},j=()=>{_.value={..._.value,isLoadingIntervalStatus:!0}},is=()=>{o.findDriver!==null&&(clearTimeout(o.findDriver),o.findDriver=null),z(),b.send({driver:"find",cmd:"start"}),o.findDriver=window.setTimeout(()=>{D.showError("Нет связи с мастером"),y(),o.findDriver=null},5*6e4)};function ce(){o.updateDrivers&&(clearTimeout(o.updateDrivers),o.updateDrivers=null),c.updateDrivers=c.updateDrivers==null?0:c.updateDrivers,z(),b.send({driver:"update",cmd:"start"}),o.updateDrivers=window.setTimeout(()=>{c.updateDrivers<1?(c.updateDrivers=c.updateDrivers+1,ce()):(D.showError("Нет связи с мастером при обновлении"),y(),clearTimeout(o.updateDrivers),o.updateDrivers=null,c.updateDrivers=0)},3e4)}function os(s){o.saveDrivers&&(clearTimeout(o.saveDrivers),o.saveDrivers=null),c.saveDrivers=c.saveDrivers==null?0:c.saveDrivers,z(),b.send({...s}),o.saveDrivers=window.setTimeout(()=>{c.saveDrivers<1?(c.saveDrivers=c.saveDrivers+1,os(s)):(D.showError("Нет связи с мастером при сохранении"),y(),clearTimeout(o.saveDrivers),o.saveDrivers=null,c.saveDrivers=0)},1e4)}function cs(s){const e="saveSettingsDriver";o[e]&&(clearTimeout(o[e]),o[e]=null),c[e]=c[e]==null?0:c[e],z(),b.send({...s}),o[e]=window.setTimeout(()=>{c[e]<1?(c[e]=c[e]+1,cs(s)):(D.showError("Нет связи при обновлении драйвера"),y(),clearTimeout(o[e]),o[e]=null,c[e]=0)},1e4)}function X(s){if(s.cmd==="stop"){b.send({...s}),Q(void 0),clearTimeout(o.startTestDriver),o.startTestDriver=null,c.startTestDriver=0,Q();return}const e="startTestDriver";o[e]&&(clearTimeout(o[e]),o[e]=null),c[e]=c[e]==null?0:c[e],b.send({...s}),Q(Number(s==null?void 0:s.address)),o[e]=window.setTimeout(()=>{c[e]<1?(c[e]=c[e]+1,X(s)):(D.showError("Нет связи при тестировании драйвера"),y(),clearTimeout(o[e]),o[e]=null,c[e]=0)},1e4)}function ne(s){z();const e="saveWIFI";o[e]&&(clearTimeout(o[e]),o[e]=null),c[e]=c[e]==null?0:c[e],b.send({...s}),o[e]=window.setTimeout(()=>{c[e]<1?(c[e]=c[e]+1,ne(s)):(D.showError("Нет связи при сохранеии WiFi настроек"),y(),clearTimeout(o[e]),o[e]=null,c[e]=0)},1e4)}function me(s){z();const e="scanWIFI";o[e]&&(clearTimeout(o[e]),o[e]=null),c[e]=c[e]==null?0:c[e],b.send({...s}),o[e]=window.setTimeout(()=>{c[e]<1?(c[e]=c[e]+1,me(s)):(D.showError("Нет связи при сканировании WiFi настроек"),y(),clearTimeout(o[e]),o[e]=null,c[e]=0)},1e4)}const y=()=>{_.value={..._.value,isLoadingUI:!1}},ls=s=>{l.value={...l.value,wifiNetworks:s}},ds=s=>{l.value={...l.value,socketStatus:s}},as=s=>{l.value={...l.value,rooms:s}},Q=s=>{l.value={...l.value,testingDriverAddress:s}};b.onStatus(s=>{ds(s)});const fe=(s,e=!0)=>{e&&z(),b.send(s)};b.onMessage(s=>{console.log("onMessage",s),s.driver==="find"&&s.cmd==="stop"&&(o.findDriver!==null&&(clearTimeout(o.findDriver),o.findDriver=null),D.showSuccess(`Найдено драйверов: ${s.count}`),l.value={...l.value,countDrivers:s.count??0},ce()),s.driver==="update"&&s.count!==void 0&&(o.updateDrivers&&(clearTimeout(o.updateDrivers),o.updateDrivers=null),c.updateDrivers=0,l.value={...l.value,updatedDevices:s.drivers},D.showSuccess("Драйверы обновлены"),y()),s.driver==="test"&&(s.cmd==="on"||s.cmd==="off")&&s.addres!==void 0&&(clearTimeout(o.startTestDriver),o.startTestDriver=null,c.startTestDriver=0,y(),l.value={...l.value,testingDriverAddress:s.addres}),s.driver==="test"&&s.cmd==="stop"&&s.status==="ok"&&(clearTimeout(o.startTestDriver),o.startTestDriver=null,c.startTestDriver=0,D.showSuccess("Тестирование остановлено"),y(),Q()),s.driver==="settyngs"&&s.cmd==="download"&&Array.isArray(s.dr_settyngs)&&(clearTimeout(o.saveSettingsDriver),o.saveSettingsDriver=null,c.saveSettingsDriver=0,D.showSuccess("Настройки обновлены"),l.value={...l.value,settingsDriver:s.dr_settyngs},y()),s.driver==="settyngs"&&s.cmd==="save"&&s.state==="ok"&&(clearTimeout(o.saveDrivers),o.saveDrivers=null,c.saveDrivers=0,y(),D.showSuccess("Настройки сохранены")),s.master==="reset"&&s.cmd==="ok"&&y(),s.master==="bus"&&s.cmd==="state"&&(clearTimeout(o.stateBus),o.stateBus=null,l.value={...l.value,stateBus:s.state}),s.master==="net"&&s.cmd==="ok"&&(clearTimeout(o.saveWIFI),clearTimeout(o.saveAP),o.saveWIFI=null,o.saveAP=null,c.saveWIFI=0,c.saveAP=0,D.showSuccess("Настройки WiFi сохранены"),y()),s.master==="scan"&&s.cmd==="stop"&&Array.isArray(s.ssid)&&(ls(s.ssid),clearTimeout(o.scanWIFI),o.scanWIFI=null,c.scanWIFI=0,D.showSuccess("SSID получены"),y()),s.rooms==="search"&&s.cmd==="download"&&(as(s.roomsArr),y())});const us=({children:s})=>(F(),C(()=>(b.connect(l.value.socketURL),()=>{b.disconnect()}),[]),C(()=>{const e=b.onMessage(r=>{if(typeof r=="string"){if(r==="free"&&ns(),(r==="busy"||r!=="free")&&j(),r!=null&&r.startsWith("sfd")){const i=parseInt(r.slice(3),10);j(),ae(i)}if(r!=null&&r.startsWith("sfs")){const i=parseInt(r.slice(3),10);j(),ae(i)}r!=="free"&&!(r!=null&&r.startsWith("sfd"))&&!(r!=null&&r.startsWith("sfs"))&&(j(),D.showError(`Неизвестный статус ${r}`))}}),n=window.setInterval(()=>{b.send("status")},3e3);return()=>{e(),clearInterval(n)}},[]),C(()=>{l.value.socketStatus==="connected"&&(j(),fe("status",!1))},[l.value.socketStatus]),t("div",{className:ts.layoutContainer,children:[t(Re,{}),t(je,{children:s}),t(es,{})]})),vs=()=>{const s=q();return C(()=>{setTimeout(()=>{s.route("/service/devices")},0)},[s]),null},hs="_panel_1hyrc_11",ps="_wifiNetworksWrapper_1hyrc_94",ms="_wifiNetworks_1hyrc_94",fs="_devices_1hyrc_159",gs="_wrapperBtn_1hyrc_167",_s="_content_1hyrc_204",bs="_settingsAndGroupWrapper_1hyrc_285",ws="_buttonTabs_1hyrc_285",ys="_buttonTabItemSettings_1hyrc_288",Ds="_buttonTabItemGroup_1hyrc_289",Cs="_buttonTabItemActiveSettings_1hyrc_317",Ns="_buttonTabItemActiveGroup_1hyrc_318",Is="_contentBody_1hyrc_345",I={panel:hs,wifiNetworksWrapper:ps,wifiNetworks:ms,devices:fs,wrapperBtn:gs,content:_s,settingsAndGroupWrapper:bs,buttonTabs:ws,buttonTabItemSettings:ys,buttonTabItemGroup:Ds,buttonTabItemActiveSettings:Cs,buttonTabItemActiveGroup:Ns,contentBody:Is},xs="_overlay_1xj4c_2",Ms="_modal_1xj4c_16",Ws="_modalContainer_1xj4c_26",ks="_fullScreen_1xj4c_38",Ts="_closeBtn_1xj4c_45",Ss="_actions_1xj4c_61",Ls="_buttonCancel_1xj4c_69",As="_buttonConfirm_1xj4c_70",S={overlay:xs,modal:Ms,modalContainer:Ws,fullScreen:ks,closeBtn:Ts,actions:Ss,buttonCancel:Ls,buttonConfirm:As},Bs={xs:"360px",sm:"480px",md:"600px",lg:"800px",xl:"1000px"};function ge({open:s,onClose:e,children:n,maxWidth:r="sm",fullWidth:i=!1,fullScreen:d=!1,buttonsType:a="none",singleButtonText:v="Понятно",singleButtonAction:p,dualPrimaryButtonText:m="Да",dualPrimaryButtonAction:f,dualSecondaryButtonText:w="Нет",dualSecondaryButtonAction:T,showCloseButton:N=!0}){if(C(()=>{const A=R=>{R.key==="Escape"&&e()};return s&&document.addEventListener("keydown",A),()=>document.removeEventListener("keydown",A)},[s]),!s)return null;const x=()=>{p?p():e()};return C(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[s]),t("div",{className:S.overlay,onClick:e,children:t("div",{className:`${S.modal} ${d?S.fullScreen:""}`,style:{maxWidth:d||i?"100%":Bs[r]},onClick:A=>A.stopPropagation(),children:t("div",{className:S.modalContainer,children:[N&&t("button",{className:S.closeBtn,onClick:e,children:"×"}),n,a!=="none"&&t("div",{className:S.actions,children:[a==="dual"&&t(G,{children:[t("button",{className:S.buttonCancel,onClick:T||e,children:w}),t("button",{className:S.buttonConfirm,onClick:f,children:m})]}),a==="single"&&t("button",{className:S.buttonConfirm,onClick:x,style:{width:"100%"},children:v})]})]})})})}function _e(){const[s,e]=g(1);return C(()=>{const n=setInterval(()=>{e(r=>r%3+1)},500);return()=>clearInterval(n)},[]),t("div",{style:{position:"relative",display:"inline-block",paddingRight:"1px",fontSize:"18px"},children:["Подождите",t("span",{style:{position:"absolute",left:"100%",top:0,marginLeft:"4px"},children:".".repeat(s)})]})}const zs="_btn_cmid8_2",$s="_lampWrapper_cmid8_50",ue={btn:zs,lampWrapper:$s},be=({width:s=251.7,height:e=255.1,scale:n=1,stripesColor:r="#FFFF00",bulbColor:i="#FFFFFF",className:d="",animateStripes:a=!0,animationSpeed:v=1e3})=>{const p=typeof s=="number"?s*n:s,m=typeof e=="number"?e*n:e,[f,w]=g(1);return C(()=>{if(!a)return;const T=setInterval(()=>{w(N=>N===1?0:1)},v);return()=>clearInterval(T)},[a,v]),t("svg",{width:p,height:m,viewBox:"0 0 251.7 255.1",class:`light-bulb-icon ${d}`,xmlns:"http://www.w3.org/2000/svg",children:[t("g",{style:{opacity:a?f:1},children:[t("path",{fill:r,d:"M27.2,44l8.1-8.1l32,32L59.2,76L27.2,44z"}),t("path",{fill:r,d:"M27.3,188.1l32-32l8.1,8.1l-32,32L27.3,188.1z"}),t("path",{fill:r,d:"M189,67.9l32-32l8,8.1l-32,32L189,67.9z"}),t("path",{fill:r,d:"M189,164l8.1-8.1l32,32L221,196L189,164z"}),t("path",{fill:r,d:"M0,110.2h45.2v11.4H0V110.2z"}),t("path",{fill:r,d:"M206.5,110.2h45.2v11.4h-45.2V110.2z"}),t("path",{fill:r,d:"M122.2,0h11.4v45.2h-11.4C122.2,45.2,122.2,0,122.2,0z"})]}),t("g",{children:t("path",{fill:i,d:`M77.5,145.9c13.7,27.4,18.9,37.3,18.9,37.3l31.5,0.1l31.4,0.1c0,0,4.6-10,19.3-37.2c8.6-14.2,11.2-30.3,7.5-45.4
          c-3.7-14.8-13.2-27.4-26.8-35.5c-9.7-5.8-20.3-8.4-30.8-8.2c-10.5-0.2-21.2,2.3-30.9,8c-13.6,8-23.2,20.5-27,35.3
          C66.5,115.5,69.1,131.7,77.5,145.9L77.5,145.9z M81.9,103.4c3-11.7,10.7-21.6,21.5-28c7.8-4.6,16.4-6.6,24.8-6.4
          c8.4-0.1,17,1.9,24.8,6.6c10.8,6.4,18.4,16.4,21.3,28.1c3,12,0,24.5-6.1,36.4c-8.7,17.2-14.5,25.3-16.5,30.5h-47.8
          c-5.3-9.8-7.5-13.2-16.3-30.8C81.8,127.9,78.9,115.4,81.9,103.4L81.9,103.4z`})}),t("path",{fill:i,d:`M147.3,207.7v17.7c-1,9.8-9.1,17.7-18.5,17.7h-1.7c-10.1,0-18.6-9-18.6-19.7v-14.6h-0.1v-1.1L147.3,207.7 M159.3,195.7H96.4
        v25.1h0.1v2.6c0,17.4,13.8,31.7,30.6,31.7h1.7c16.8,0,30.6-14.3,30.6-31.7v-2.6h-0.1V195.7L159.3,195.7z`}),t("path",{fill:r,d:"M105.9,230.3h44.5v6h-44.5C105.9,236.3,105.9,230.3,105.9,230.3z"})]})},V=({text:s="Кнопка",onClick:e,sx:n,lampVisible:r=!1})=>(F(),t("div",{className:ue.btn,style:{...n},id:"device-btn-update",onClick:i=>{e==null||e(i)},children:[t("span",{style:{visibility:r?"hidden":"visible"},children:[" ",`${s}`]}),r&&t("div",{className:ue.lampWrapper,children:t(be,{animateStripes:!0,animationSpeed:1e3})})]}));function It(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function Gs(s=5e3){return new Promise((e,n)=>{let r=!1;const i=window.setTimeout(()=>{r||(a==null||a(),n(new Error("таймаут проверки мастера")))},s),d=v=>{v==="free"&&(clearTimeout(i),a==null||a(),r=!0,v==="free"&&e())},a=b.onMessage(d);b.send("status")})}function L(s){return(...e)=>{z(),Gs().then(()=>{s(...e)}).catch(n=>{y(),D.showError("Мастер занят, попробуйте чуть позже"),console.log("Мастер не свободен для",s.name,n)})}}const Ps=()=>{const[s,e]=g("ap"),[n,r]=g(""),[i,d]=g(""),[a,v]=g(""),[p,m]=g(!1),{isMobile440:f}=F(),w=_.value.isLoadingUI||_.value.isLoadingIntervalStatus,T=oe(null),[N,x]=g(!1);$(()=>{fe({master:"reset",cmd:"start"})},[]),$(()=>{a.length>0&&(rs(a),l.value={...l.value,socketURL:a})},[a]);const A=$(()=>{s==="host"?n.trim()&&i.trim()?(x(!0),L(ne)({master:"net",cmd:"save",memory:"yes",mode:s,ssid:n,password:i})):alert("Пожалуйста, введите SSID и пароль"):s=="ap"&&(x(!0),L(ne)({master:"net",cmd:"save",memory:"yes",mode:s}))},[n,i,s]),R=$(()=>{r(""),w||L(me)({master:"scan",cmd:"start"})},[w]);return C(()=>{N&&!w&&setTimeout(()=>{m(!0),x(!1)},0)},[N,w]),t("div",{className:I.devices,children:[t("div",{id:"drivers-list",className:I.content,children:t("div",{className:I.settingsAndGroupWrapper,children:[t("div",{className:I.buttonTabs,children:[t("div",{className:de(s==="ap"?I.buttonTabItemActiveSettings:I.buttonTabItemSettings),onClick:()=>e("ap"),children:f?t("span",{children:["Создать точку",t("br",{})," доступа"]}):t("span",{children:" Создать точку доступа"})}),t("div",{className:de(s==="host"?I.buttonTabItemActiveGroup:I.buttonTabItemGroup),onClick:()=>e("host"),children:f?t("span",{children:[" ","Подключиться",t("br",{})," к WiFi"]}):t("span",{children:" Подключиться к WiFi"})})]}),t("div",{className:I.contentBody,children:[s==="host"&&t("div",{className:I.panel,children:[t("div",{style:{display:"flex",flexDirection:"column",fontSize:"20px"},children:[t("div",{children:" Имя сети:"}),t("div",{ref:T,style:{position:"relative"},children:t("input",{autoComplete:"off",type:"text",id:"wifi-ssid",placeholder:"Введите имя сети",value:n,onInput:M=>{const Z=M.target.value;r(Z)}})})]}),t("label",{children:["Пароль:",t("input",{autoComplete:"off",type:"text",id:"wifi-password",placeholder:"Введите пароль",value:i,onInput:M=>d(M.target.value)})]}),t("div",{style:{display:"flex",justifyContent:"center",marginTop:"10px"},children:t(V,{text:"Сканировать WiFi",onClick:R,sx:{width:"auto"}})}),t("div",{className:I.wifiNetworksWrapper,children:t("div",{className:I.wifiNetworks,children:l.value.wifiNetworks.map(M=>t(V,{text:M,onClick:()=>r(M),sx:{width:"auto"}}))})})]}),s==="ap"&&t(G,{})]})]})}),t(ge,{maxWidth:"md",open:p,onClose:()=>{},buttonsType:"none",singleButtonText:"Отмена",showCloseButton:!1,singleButtonAction:()=>{m(!1)},children:t(G,{children:t("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",gap:"40px",padding:"16px 0",marginBottom:"20px"},children:s==="ap"?t("div",{style:{fontSize:"20px",fontWeight:"600",textAlign:"center"},children:["Режим точки доступа запущен.",t("br",{}),"Переподключитесь на сеть DALI Master по адресу:",t("p",{children:t("a",{href:`http://${P}`,target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none",color:"white"},children:`http://${P}`})}),t("button",{onClick:()=>{window.location.href=`http://${P}`},style:{marginTop:"20px",padding:"12px 24px",backgroundColor:"#444",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Перейти сейчас"})]}):t("div",{style:{fontSize:"20px",fontWeight:"600",textAlign:"center"},children:["Подключитесь к WiFi",t("br",{}),"Переподключитесь на сеть DALI Master по адресу:",t("p",{children:t("a",{href:`http://${P}`,target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none",color:"white"},children:`http://${P}`})}),t("p",{style:{marginTop:"10px"}}),t("button",{onClick:()=>{window.location.href=`http://${P}`},style:{marginTop:"20px",padding:"12px 24px",backgroundColor:"#444",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Перейти сейчас"})]})})})}),t("div",{className:I.wrapperBtn,children:w?t("div",{className:I.loadingText,children:t(_e,{})}):t(G,{children:t("div",{style:{display:"flex",gap:"20px"},children:t(V,{text:s==="ap"?"Создать точку доступа":"Подключиться к сети",sx:{width:"auto"},onClick:()=>{A()}})})})})]})};function xt(s,e){const n=[];for(let r=0;r<8;r++){const i=Math.pow(2,r);Math.floor(s/i)%2===1&&n.push(r)}for(let r=0;r<8;r++){const i=Math.pow(2,r);Math.floor(e/i)%2===1&&n.push(r+8)}return n.sort((r,i)=>r-i)}function Mt(s){let e=0,n=0;return s.forEach(r=>{r>=0&&r<8?e+=Math.pow(2,r):r>=8&&r<16&&(n+=Math.pow(2,r-8))}),{g07:e,g815:n}}const ve=({width:s=32,height:e=32,scale:n=1,color:r="#ffffff",className:i="",direction:d="right",double:a=!0,onClick:v,gap:p=8})=>{const m=typeof s=="number"?s*n:s,f=typeof e=="number"?e*n:e,w=typeof p=="number"?p*n:p,T=d==="left"?"scaleX(-1)":"scaleX(1)",N="M62.8,188.6L14.1,94.3L62.8,0h-14L0,94.3l48.7,94.3H62.8z";return t("svg",{onClick:()=>{v==null||v()},width:m,height:f,viewBox:"0 0 125.6 188.6",class:`double-arrow-icon ${i}`,xmlns:"http://www.w3.org/2000/svg",style:{transform:T,transformOrigin:"center",flexShrink:0},children:[t("defs",{children:t("style",{children:`.cls-1{fill:${r};}`})}),t("path",{class:"cls-1",d:N,transform:"translate(0,0)"}),a&&t("path",{className:"cls-1",d:N,transform:`translate(${62.8+w},0)`})]})},Wt=({width:s=56,height:e=56,scale:n=1,color:r="#ffffff",className:i=""})=>{const d=typeof s=="number"?s*n:s,a=typeof e=="number"?e*n:e;return t("svg",{width:d,height:a,viewBox:"0 0 24 24",class:`speaker-icon ${i}`,xmlns:"http://www.w3.org/2000/svg",style:{fill:r,flexShrink:0},children:t("g",{children:t("path",{d:`M19.164,19.547c-1.641-2.5-3.669-3.285-6.164-3.484v1.437c0,0.534-0.208,1.036-0.586,1.414
        c-0.756,0.756-2.077,0.751-2.823,0.005l-6.293-6.207C3.107,12.523,3,12.268,3,11.999s0.107-0.524,0.298-0.712l6.288-6.203
        c0.754-0.755,2.073-0.756,2.829,0.001C12.792,5.463,13,5.965,13,6.499v1.704c4.619,0.933,8,4.997,8,9.796v1
        c0,0.442-0.29,0.832-0.714,0.958c-0.095,0.027-0.19,0.042-0.286,0.042C19.669,19.999,19.354,19.834,19.164,19.547z
        M12.023,14.011c2.207,0.056,4.638,0.394,6.758,2.121c-0.768-3.216-3.477-5.702-6.893-6.08C11.384,9.996,11,10,11,10V6.503
        l-5.576,5.496l5.576,5.5V14C11,14,11.738,14.01,12.023,14.011z`})})})},Es="_container_1t5q4_2",Fs="_channelNumber_1t5q4_29",Rs="_indicators_1t5q4_58",Os="_dot_1t5q4_68",Hs="_dashes_1t5q4_81",js="_name_1t5q4_87",Us="_button_1t5q4_97",Vs="_red_1t5q4_121",qs="_green_1t5q4_125",Ks="_blue_1t5q4_129",Xs="_white_1t5q4_133",Qs="_warm_1t5q4_137",Js="_cold_1t5q4_141",U={container:Es,channelNumber:Fs,indicators:Rs,dot:Os,dashes:Hs,name:js,button:Us,red:Vs,green:qs,blue:Ks,white:Xs,warm:Qs,cold:Js},Ys="_container_st7jg_1",Zs="_label_st7jg_11",et="_triangle_st7jg_21",re={container:Ys,label:Zs,triangle:et};function he({led:s}){return t("div",{className:re.container,children:[s&&t("span",{className:re.label,children:"LED"}),t("div",{className:re.triangle})]})}const st=({size:s=100,color:e="#fef7cb",strokeWidth:n=2})=>t("svg",{width:s,height:s*56/100,viewBox:"0 0 100 56",xmlns:"http://www.w3.org/2000/svg",children:t("g",{stroke:e,"stroke-width":n,"stroke-linecap":"round",fill:"none",children:[t("line",{x1:"2",y1:"35",x2:"30",y2:"35"}),t("line",{x1:"30",y1:"35",x2:"50",y2:"17"}),t("line",{x1:"56",y1:"35",x2:"95",y2:"35"})]})}),tt=({width:s=180,height:e=120,scale:n=1,mainColor:r="#ffeb3b",backColor:i="#ffeb3b",className:d=""})=>{const a=typeof s=="number"?s*n:s,v=typeof e=="number"?e*n:e;return t("svg",{width:a,height:v,viewBox:"0 0 180 120",className:`bulb-group ${d}`,xmlns:"http://www.w3.org/2000/svg",children:[t("g",{transform:"translate(30, 15) scale(0.7)",children:t("path",{d:"M69.294,11.442c-6.788-5.594-15.724-7.82-24.512-6.109C32.951,7.636,23.449,17.623,21.675,29.62c-1.447,9.79,2.031,19.567,9.304,26.155c3.277,2.968,5.254,7.243,5.568,12.039c0.006,0.087,0.023,0.171,0.042,0.254v15.039c0,0.828,0.671,1.5,1.5,1.5h1.495c0.609,4.359,3.813,7.697,7.672,7.697h6.81c3.859,0,7.062-3.338,7.671-7.697h1.495c0.828,0,1.5-0.672,1.5-1.5V67.828c0-0.003,0.001-0.006,0.001-0.01c0-4.462,2.026-8.771,5.706-12.133c6.062-5.538,9.538-13.415,9.538-21.61C79.978,25.287,76.084,17.037,69.294,11.442z M45.357,39.91h-2.305c-1.271,0-2.305-1.034-2.305-2.305s1.034-2.305,2.305-2.305s2.305,1.034,2.305,2.305V39.91z M55.966,37.605c0-1.271,1.034-2.305,2.306-2.305c1.271,0,2.305,1.034,2.305,2.305s-1.034,2.305-2.305,2.305h-2.303L55.966,37.605z M55.063,69.211h6.67v12.396H60.36c-0.003,0-0.006-0.001-0.01-0.001s-0.006,0.001-0.01,0.001H40.982c-0.003,0-0.006-0.001-0.01-0.001s-0.006,0.001-0.01,0.001H39.59V69.211h14.366 M48.357,66.211V42.91h4.617l0.034,23.301H48.357z M54.066,89.304h-6.81c-2.238,0-4.117-2.004-4.637-4.697h16.083C58.183,87.3,56.304,89.304,54.066,89.304z M68.416,53.471c-3.872,3.537-6.164,8.013-6.593,12.74h-5.816L55.974,42.91h2.298c2.925,0,5.305-2.38,5.305-5.305c0-2.925-2.38-5.305-5.305-5.305c-2.926,0-5.306,2.38-5.306,5.307l0.003,2.303h-4.612v-2.305c0-2.925-2.38-5.305-5.305-5.305c-2.925,0-5.305,2.38-5.305,5.305c0,2.925,2.38,5.305,5.305,5.305h2.305v23.301h-5.972c-0.636-5.005-2.864-9.465-6.393-12.66c-6.528-5.914-9.65-14.696-8.35-23.493c1.591-10.76,10.108-19.716,20.712-21.781c7.908-1.538,15.938,0.458,22.03,5.48c6.096,5.023,9.592,12.429,9.592,20.319C76.978,41.43,73.857,48.5,68.416,53.471z",fill:i,opacity:"0.8"})}),t("g",{transform:"translate(105, 15) scale(0.7)",children:t("path",{d:"M69.294,11.442c-6.788-5.594-15.724-7.82-24.512-6.109C32.951,7.636,23.449,17.623,21.675,29.62c-1.447,9.79,2.031,19.567,9.304,26.155c3.277,2.968,5.254,7.243,5.568,12.039c0.006,0.087,0.023,0.171,0.042,0.254v15.039c0,0.828,0.671,1.5,1.5,1.5h1.495c0.609,4.359,3.813,7.697,7.672,7.697h6.81c3.859,0,7.062-3.338,7.671-7.697h1.495c0.828,0,1.5-0.672,1.5-1.5V67.828c0-0.003,0.001-0.006,0.001-0.01c0-4.462,2.026-8.771,5.706-12.133c6.062-5.538,9.538-13.415,9.538-21.61C79.978,25.287,76.084,17.037,69.294,11.442z M45.357,39.91h-2.305c-1.271,0-2.305-1.034-2.305-2.305s1.034-2.305,2.305-2.305s2.305,1.034,2.305,2.305V39.91z M55.966,37.605c0-1.271,1.034-2.305,2.306-2.305c1.271,0,2.305,1.034,2.305,2.305s-1.034,2.305-2.305,2.305h-2.303L55.966,37.605z M55.063,69.211h6.67v12.396H60.36c-0.003,0-0.006-0.001-0.01-0.001s-0.006,0.001-0.01,0.001H40.982c-0.003,0-0.006-0.001-0.01-0.001s-0.006,0.001-0.01,0.001H39.59V69.211h14.366 M48.357,66.211V42.91h4.617l0.034,23.301H48.357z M54.066,89.304h-6.81c-2.238,0-4.117-2.004-4.637-4.697h16.083C58.183,87.3,56.304,89.304,54.066,89.304z M68.416,53.471c-3.872,3.537-6.164,8.013-6.593,12.74h-5.816L55.974,42.91h2.298c2.925,0,5.305-2.38,5.305-5.305c0-2.925-2.38-5.305-5.305-5.305c-2.926,0-5.306,2.38-5.306,5.307l0.003,2.303h-4.612v-2.305c0-2.925-2.38-5.305-5.305-5.305c-2.925,0-5.305,2.38-5.305,5.305c0,2.925,2.38,5.305,5.305,5.305h2.305v23.301h-5.972c-0.636-5.005-2.864-9.465-6.393-12.66c-6.528-5.914-9.65-14.696-8.35-23.493c1.591-10.76,10.108-19.716,20.712-21.781c7.908-1.538,15.938,0.458,22.03,5.48c6.096,5.023,9.592,12.429,9.592,20.319C76.978,41.43,73.857,48.5,68.416,53.471z",fill:i,opacity:"0.8"})}),t("g",{transform:"translate(60, 5) scale(0.85)",children:t("path",{d:"M69.294,11.442c-6.788-5.594-15.724-7.82-24.512-6.109C32.951,7.636,23.449,17.623,21.675,29.62c-1.447,9.79,2.031,19.567,9.304,26.155c3.277,2.968,5.254,7.243,5.568,12.039c0.006,0.087,0.023,0.171,0.042,0.254v15.039c0,0.828,0.671,1.5,1.5,1.5h1.495c0.609,4.359,3.813,7.697,7.672,7.697h6.81c3.859,0,7.062-3.338,7.671-7.697h1.495c0.828,0,1.5-0.672,1.5-1.5V67.828c0-0.003,0.001-0.006,0.001-0.01c0-4.462,2.026-8.771,5.706-12.133c6.062-5.538,9.538-13.415,9.538-21.61C79.978,25.287,76.084,17.037,69.294,11.442z M45.357,39.91h-2.305c-1.271,0-2.305-1.034-2.305-2.305s1.034-2.305,2.305-2.305s2.305,1.034,2.305,2.305V39.91z M55.966,37.605c0-1.271,1.034-2.305,2.306-2.305c1.271,0,2.305,1.034,2.305,2.305s-1.034,2.305-2.305,2.305h-2.303L55.966,37.605z M55.063,69.211h6.67v12.396H60.36c-0.003,0-0.006-0.001-0.01-0.001s-0.006,0.001-0.01,0.001H40.982c-0.003,0-0.006-0.001-0.01-0.001s-0.006,0.001-0.01,0.001H39.59V69.211h14.366 M48.357,66.211V42.91h4.617l0.034,23.301H48.357z M54.066,89.304h-6.81c-2.238,0-4.117-2.004-4.637-4.697h16.083C58.183,87.3,56.304,89.304,54.066,89.304z M68.416,53.471c-3.872,3.537-6.164,8.013-6.593,12.74h-5.816L55.974,42.91h2.298c2.925,0,5.305-2.38,5.305-5.305c0-2.925-2.38-5.305-5.305-5.305c-2.926,0-5.306,2.38-5.306,5.307l0.003,2.303h-4.612v-2.305c0-2.925-2.38-5.305-5.305-5.305c-2.925,0-5.305,2.38-5.305,5.305c0,2.925,2.38,5.305,5.305,5.305h2.305v23.301h-5.972c-0.636-5.005-2.864-9.465-6.393-12.66c-6.528-5.914-9.65-14.696-8.35-23.493c1.591-10.76,10.108-19.716,20.712-21.781c7.908-1.538,15.938,0.458,22.03,5.48c6.096,5.023,9.592,12.429,9.592,20.319C76.978,41.43,73.857,48.5,68.416,53.471z",fill:r})})]})},rt="_btn_15cnz_2",nt="_lampWrapper_15cnz_51",pe={btn:rt,lampWrapper:nt},J=({text:s="Кнопка",onClick:e,sx:n,lampVisible:r=!1,disabled:i=!1})=>{const{isMobile380:d,isMobile360:a,isMobile340:v}=F(),p=()=>v?28:a?30:36;return t("div",{className:pe.btn,style:{...n},id:"device-btn-update",onClick:m=>{i||e==null||e(m)},children:[t("span",{style:{visibility:r?"hidden":"visible"},children:[" ",`${s}`]}),r&&t("div",{className:pe.lampWrapper,children:t(be,{animateStripes:!0,height:p(),width:p(),animationSpeed:1e3})})]})},it={2:["warm","cold"],4:"triangle",6:"triangleWithLed",7:"rele",96:["red","green","blue"],98:["red","green","blue","white"],128:["red","green","blue","cold","warm"],group:"group"};function ot({address:s,editPencil:e=!1,type:n,onClick:r,onClickTest:i,onClickSettings:d,lampVisible:a,disabled:v=!1,...p}){const m=it[`${n}`];return t("div",{className:`${U.container}`,...p,children:[t("span",{className:U.channelNumber,children:s}),t("div",{className:U.indicators,children:[Array.isArray(m)&&m.map((f,w)=>t("span",{className:`${U.dot} ${U[f]}`},f+w)),m==="triangleWithLed"&&t(he,{led:!0}),m==="triangle"&&t(he,{led:!1}),m==="rele"&&t(st,{size:56,strokeWidth:5}),m==="group"&&t(tt,{})]}),t(J,{disabled:v,text:"Настройки",sx:{padding:"9px 7px"},onClick:f=>{d(),f.stopPropagation()}}),t(J,{disabled:v,text:"Тест",lampVisible:a,sx:{padding:"9px 7px"},onClick:f=>{i==null||i(),f.stopPropagation()}})]})}const ct="_driversList_nutbd_3",lt="_loadingText_nutbd_28",dt="_devices_nutbd_44",at="_wrapperBtn_nutbd_55",ut="_totalCount_nutbd_94",vt="_paginationBar2_nutbd_110",ht="_arrowPagination_nutbd_123",pt="_dotsWrapper_nutbd_150",mt="_dots_nutbd_150",ft="_dot_nutbd_150",gt="_active_nutbd_174",k={driversList:ct,loadingText:lt,devices:dt,wrapperBtn:at,totalCount:ut,paginationBar2:vt,arrowPagination:ht,dotsWrapper:pt,dots:mt,dot:ft,active:gt},_t=s=>new Promise(e=>setTimeout(e,s));function bt(){const s=oe(null),{route:e}=q(),[n,r]=g(!1),[i,d]=g(1),[a,v]=g([]),[p,m]=g(1),[f,w]=g(8);F();const[T,N]=g(!1),x=_.value.isLoadingUI||_.value.isLoadingIntervalStatus,A=l.value.socketStatus,R=$(()=>{r(!0)},[]),M=$(()=>{L(ce)()},[]),Z=async h=>{if(l.value.testingDriverAddress===h){ee();return}l.value.testingDriverAddress!==void 0?(ee(),await _t(200),L(X)({driver:"test",cmd:"start",addres:+h})):L(X)({driver:"test",cmd:"start",addres:+h})},ee=()=>{if(l.value.testingDriverAddress===void 0)return;L(X)({driver:"test",cmd:"stop",addres:+l.value.testingDriverAddress})};C(()=>{if(s.current){const h=s.current.getBoundingClientRect().height,W=60,O=16,se=Math.round((h-20+O)/(W+O)),ye=Math.max(1,se);w(ye)}},[s.current]),C(()=>{const h=Object.keys(l.value.updatedDevices);if(h.length>0){const W=Math.ceil(h.length/f);m(W);const O=(i-1)*f,le=O+f,se=h.slice(O,le);v(se)}else v([]),m(1)},[l.value.updatedDevices,i,f]),C(()=>()=>{ee()},[]),C(()=>{if(l.value.socketStatus==="connected"){const W=setTimeout(()=>{N(!1)},2e3);return()=>clearTimeout(W)}else N(!0)},[l.value.socketStatus]);const we=Object.keys(l.value.updatedDevices).length;return t("div",{className:k.devices,children:[t("div",{id:"drivers-list",className:k.driversList,ref:s,children:a.map(h=>t(ot,{disabled:x,lampVisible:+l.value.updatedDevices[h][0]===l.value.testingDriverAddress,type:l.value.updatedDevices[h][1],address:l.value.updatedDevices[h][0],onClickSettings:()=>{L(e)(`/service/devices/${l.value.updatedDevices[h][0]}`)},onClickTest:()=>{Z(+l.value.updatedDevices[h][0])}},l.value.updatedDevices[h][0]))}),t("div",{className:k.paginationBar2,children:[t("div",{style:{marginRight:"5px",visibility:i===1?"hidden":"visible",fontSize:"38px",left:"0"},className:k.arrowPagination,onClick:()=>d(h=>Math.max(h-1,1)),children:t(ve,{direction:"right"})}),t("div",{style:{marginLeft:"5px",visibility:i===p?"hidden":"visible",fontSize:"38px",right:"0"},className:k.arrowPagination,onClick:()=>d(h=>Math.min(h+1,p)),children:t(ve,{direction:"left"})}),t("div",{className:k.totalCount,children:we}),t("div",{className:k.dotsWrapper,children:p>0&&t("div",{className:k.dots,children:Array.from({length:p}).map((h,W)=>t("span",{className:`${k.dot} ${i===W+1?k.active:""}`,onClick:()=>d(W+1)},W))})})]}),t("div",{className:k.wrapperBtn,children:x&&A==="connected"?t("div",{className:k.loadingText,children:t(_e,{})}):t(G,{children:[t(V,{text:"Обновить",onClick:M}),t(V,{text:"Поиск ",onClick:R})]})}),t(ge,{maxWidth:"md",open:n,onClose:()=>{},buttonsType:"single",singleButtonText:"Отмена",showCloseButton:!1,singleButtonAction:()=>{r(!1)},children:t(G,{children:t("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",gap:"40px",padding:"16px 0",marginBottom:"20px"},children:[t("div",{style:{display:"flex",flexDirection:"column"},children:[t(J,{text:"Новый поиск",onClick:()=>{L(is)(),r(!1)}}),t("span",{style:{marginTop:"10px"},children:"Все адреса и настройки будут удалены"})]}),t("div",{style:{display:"flex",flexDirection:"column"},children:[t(J,{text:"Добавить новый драйвер",onClick:()=>{M(),r(!1)}}),t("span",{style:{marginTop:"10px"},children:"Все адреса и настройки будут сохранены"})]})]})})})]})}const wt=()=>(F(),t(bt,{}));function yt(){return t(Ie,{children:t(us,{children:t(Ne,{children:[t(K,{path:"/service/devices",component:wt}),t(K,{path:"/service/devices/:id",component:xe}),t(K,{path:"/settings",component:Ps}),t(K,{default:!0,component:vs})]})})})}Ce(t(yt,{}),document.getElementById("app"));export{ve as A,V as B,_e as L,Wt as S,z as a,fe as b,l as c,cs as d,os as e,It as f,Mt as g,xt as p,_ as s,F as u,L as w};
